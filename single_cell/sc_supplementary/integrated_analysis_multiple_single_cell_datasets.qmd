---
title: "多个单细胞数据集整合分析"
---

> 参考：[单细胞多数据集整合示例](https://mp.weixin.qq.com/s/51PtUi7ZKp1nbrFGElU74A)

有时候，为了扩大数据量和得到更加可靠的结论，我们可能获取和下载了多个单细胞数据集。如果我们只关注某一细胞类型，如T cells或B cells或髓系细胞，那么就需要合并分析这些数据集，提取感兴趣的细胞亚群。这时候有两种方法可以选择：

-   **对各个数据集分别降维分群，然后提取各个数据集的感兴趣细胞亚群并整合到一起**

-   **在一开始分析的时候就对这些数据集进行整合，然后分群，提起感兴趣细胞群**

**这个部分怎么分析并没有一个特定的答案或者规则，具体还是得看数据集适合以上提出的哪种分析顺序。**

例如[@gong2023]就用了第二种方法。选取了三个鼻咽癌单细胞转录组数据： GSE150825, GSE150430, GSE162025。首先对三组数据进行整合，然后选取其中的一部分T细胞进行进一步分析。

![](images/截屏2024-01-10%2012.00.48.png){width="600"}

这里我们介绍第一种方式，即**对各数据集分别降维分群，然后提取并整合各个数据集的感兴趣细胞亚群。**

## 加载包

```{r}
library(Seurat)
```

## GSE150430

这里我们直接载入 @sec-reading_non_standard_large_volume_text 中构建好的Seurat对象，该案例数据的介绍及读取过程参见该章节。

### 数据导入

```{r}
merged_seurat_1 <- readRDS("output/sc_supplementary/GSE150430_merged_seurat.rds")
merged_seurat_1
head(merged_seurat_1, 4)
unique(merged_seurat_1$samples)
```

### 质控

```{r}
# Add number of genes per UMI for each cell to metadata
merged_seurat_1$log10GenesPerUMI <- log10(merged_seurat_1$nFeature_RNA) / log10(merged_seurat_1$nCount_RNA)
head(merged_seurat_1@meta.data)
```
