{
  "hash": "83a9bbe5bbd4fa92ee6c6b5c360e515a",
  "result": {
    "markdown": "---\ntitle: \"寻找不同样本类型间同一细胞类型内的差异基因\"\n---\n\n\n> 参考原文：[*Introduction to scRNA-seq integration*](https://satijalab.org/seurat/articles/integration_introduction#identify-differential-expressed-genes-across-conditions) *和 [Differential expression testing](https://satijalab.org/seurat/articles/de_vignette)*\n>\n> 原文发布日期：2023年10月31日\n\n# 直接通过`FindMarkers`寻找差异基因 {#sec-degs_within_the_same_cell_type_between_different_sample_types}\n\n## 数据导入\n\n导入我们在[整合（integration）](/single_cell/seurat/integration.qmd)中完成`SCTransform`和整合的单细胞数据。这里的meta.data已经提前注释好了细胞类型（储存在\"seurat_annotations\"列中）。\n\n\n::: {.cell hash='de_vignette_cache/html/unnamed-chunk-1_b3bbb11cbc1157d12ef5aacc5888428e'}\n\n```{.r .cell-code}\nlibrary(Seurat)\nifnb_integrated <- readRDS(\"output/seurat_official/ifnb_integrated.rds\")\nifnb_integrated\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAn object of class Seurat \n27359 features across 13999 samples within 2 assays \nActive assay: SCT (13306 features, 3000 variable features)\n 3 layers present: counts, data, scale.data\n 1 other assay present: RNA\n 3 dimensional reductions calculated: pca, umap, integrated.dr\n```\n:::\n\n```{.r .cell-code}\nhead(ifnb_integrated, 3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                  orig.ident nCount_RNA nFeature_RNA stim seurat_annotations\nAAACATACATTTCC.1 IMMUNE_CTRL       3017          877 CTRL          CD14 Mono\nAAACATACCAGAAA.1 IMMUNE_CTRL       2481          713 CTRL          CD14 Mono\nAAACATACCTCGCT.1 IMMUNE_CTRL       3420          850 CTRL          CD14 Mono\n                 nCount_SCT nFeature_SCT SCT_snn_res.0.6 seurat_clusters\nAAACATACATTTCC.1       1944          852               1               1\nAAACATACCAGAAA.1       1888          699               9               9\nAAACATACCTCGCT.1       1951          804               1               1\n```\n:::\n:::\n\n\n## 运行`PrepSCTFindMarkers()`，预处理SCT assay\n\n\n::: {.cell hash='de_vignette_cache/html/unnamed-chunk-2_24116b52cc2c979617f5837166df25d5'}\n\n```{.r .cell-code}\nifnb_integrated <- PrepSCTFindMarkers(ifnb_integrated)\n```\n:::\n\n\n::: callout-important\n对于经过`SCTransform`归一化处理后的单细胞数据，在进行差异分析之前，需要先运行`PrepSCTFindMarkers()`，来预处理SCT assay。详细解释见[此链接](https://www.jianshu.com/p/fb2e43905559)。\n\n如果是基于`NormalizeData`标准化的单细胞数据，需要使用\"RNA\" assay进行差异分析（见下面的[数据读取和预处理](#数据读取和预处理)），如果不是，需要通过`DefaultAssay(ifnb) <- \"RNA\"`进行设定。Note that the raw and normalized counts are stored in the `counts` and `data` layers of `RNA` assay. By default, the functions for finding markers will use normalized `data`. 关于`FindMarkers`为什么要使用\"RNA\" assay，参阅：<https://github.com/hbctraining/scRNA-seq_online/issues/58>\n:::\n\n## 准备差异表达分析所需变量 {#准备差异表达分析所需变量}\n\nWe create a column in the `meta.data` slot to hold both the cell type and treatment information and switch the current `Idents` to that column.\n\n\n::: {.cell hash='de_vignette_cache/html/unnamed-chunk-3_3f47eabfaf02d61d82bff9b829b0a07d'}\n\n```{.r .cell-code}\nifnb_integrated$celltype.stim <- paste(ifnb_integrated$seurat_annotations, \n                                       ifnb_integrated$stim, \n                                       sep = \"_\")\nunique(ifnb_integrated$celltype.stim)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"CD14 Mono_CTRL\"    \"pDC_CTRL\"          \"CD4 Memory T_CTRL\"\n [4] \"T activated_CTRL\"  \"CD4 Naive T_CTRL\"  \"CD8 T_CTRL\"       \n [7] \"Mk_CTRL\"           \"B Activated_CTRL\"  \"B_CTRL\"           \n[10] \"DC_CTRL\"           \"CD16 Mono_CTRL\"    \"NK_CTRL\"          \n[13] \"Eryth_CTRL\"        \"CD8 T_STIM\"        \"pDC_STIM\"         \n[16] \"CD4 Naive T_STIM\"  \"B_STIM\"            \"CD14 Mono_STIM\"   \n[19] \"T activated_STIM\"  \"CD4 Memory T_STIM\" \"B Activated_STIM\" \n[22] \"NK_STIM\"           \"DC_STIM\"           \"CD16 Mono_STIM\"   \n[25] \"Mk_STIM\"           \"Eryth_STIM\"       \n```\n:::\n\n```{.r .cell-code}\nIdents(ifnb_integrated) <- \"celltype.stim\"\n```\n:::\n\n\n## 执行差异表达分析\n\nThen we use `FindMarkers()` to find the genes that are different between control and stimulated B cells.\n\n\n::: {.cell hash='de_vignette_cache/html/unnamed-chunk-4_398b33352fe6b858a62a87ff4ffb6378'}\n\n```{.r .cell-code}\n# 寻找对照组和刺激组之间在B细胞中的差异基因\n\nb.interferon.response <- FindMarkers(ifnb_integrated, \n                                     ident.1 = \"B_STIM\", \n                                     ident.2 = \"B_CTRL\", \n                                     verbose = FALSE)\nhead(b.interferon.response, n = 15)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                p_val avg_log2FC pct.1 pct.2     p_val_adj\nISG15   1.505650e-159  5.1597242 0.998 0.229 2.003417e-155\nIFIT3   4.128835e-154  6.2281506 0.961 0.052 5.493827e-150\nIFI6    2.493139e-153  5.6458391 0.965 0.076 3.317371e-149\nISG20   9.385626e-152  3.1715979 1.000 0.666 1.248851e-147\nIFIT1   2.447118e-139  6.2614957 0.904 0.029 3.256136e-135\nMX1     2.111961e-124  4.1490465 0.900 0.115 2.810175e-120\nLY6E    2.930420e-122  3.9278136 0.898 0.150 3.899217e-118\nTNFSF10 1.104024e-112  6.8254288 0.785 0.020 1.469014e-108\nIFIT2   3.491368e-108  5.5668205 0.783 0.037 4.645615e-104\nB2M      3.405403e-98  0.6074989 1.000 1.000  4.531229e-94\nIRF7     1.114291e-96  3.3721350 0.834 0.187  1.482675e-92\nPLSCR1   3.364901e-96  4.0217697 0.783 0.111  4.477338e-92\nUBE2L6   1.155610e-85  2.6732717 0.849 0.295  1.537655e-81\nCXCL10   5.689834e-84  8.0923962 0.639 0.010  7.570893e-80\nPSMB9    2.304426e-81  1.8684260 0.937 0.568  3.066269e-77\n```\n:::\n:::\n\n\n::: callout-warning\nPlease note that p-values obtained from this analysis should be interpreted with caution, as **these tests treat each cell as an independent replicate, and ignore inherent correlations between cells originating from the same sample**. Such analyses have been shown to find a large number of **false positive associations**, as has been demonstrated by [@squair2021], [@zimmerman2021], [@junttila2022], and others. As discussed here [@crowell2020], DE tests across multiple conditions should expressly utilize multiple samples/replicates, and can be performed after aggregating (‘pseudobulking’) cells from the same sample and subpopulation together. Below, we show how **pseudobulking** can be used to account for such within-sample correlation.\n:::\n\n::: callout-warning\n这里没有使用进行pseudobulking的原因是，本例中“ctrl”和“sim”组都分别只有一个重复：We do not perform this analysis here, as there is a single replicate in the data.\n:::\n\n## 可视化差异基因表达\n\nAnother useful way to visualize these changes in gene expression is with the `split.by` option to the [`FeaturePlot()`](https://satijalab.org/seurat/reference/FeaturePlot.html) or [`VlnPlot()`](https://satijalab.org/seurat/reference/VlnPlot.html) function. This will display FeaturePlots of the list of given genes, split by a grouping variable (stimulation condition here).\n\n\n::: {.cell hash='de_vignette_cache/html/unnamed-chunk-5_58c96af66f12c92576553270723e2037'}\n\n```{.r .cell-code}\nFeaturePlot(ifnb_integrated, \n            features = c(\"CD3D\", \"GNLY\", \"IFI6\", \"ISG15\", \"CD14\", \"CXCL10\"), \n            split.by = \"stim\", \n            max.cutoff = 3, \n            cols = c(\"grey\", \"red\"), \n            reduction = \"umap\")\n```\n\n::: {.cell-output-display}\n![](de_vignette_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n::: {.cell hash='de_vignette_cache/html/unnamed-chunk-6_38efe29a7fde3d68409c781b6aba6a2e'}\n\n```{.r .cell-code}\nplots <- VlnPlot(ifnb_integrated,\n                 features = c(\"CD3D\", \"GNLY\", \"IFI6\", \"ISG15\", \"CD14\", \"CXCL10\", \"LYZ\"),\n                 split.by = \"stim\",\n                 group.by = \"seurat_annotations\",\n                 pt.size = 0,\n                 combine = FALSE) # 由于VlnPlot绘制组图时没有图例，所以这里取消绘制组图\nlibrary(patchwork)\nwrap_plots(plots = plots, ncol = 2) # 将plots列表组合成组图\n```\n\n::: {.cell-output-display}\n![](de_vignette_files/figure-html/unnamed-chunk-6-1.png){width=960}\n:::\n:::\n\n\n::: {.callout-note collapse=\"true\"}\n###### 结果解读\n\n-   *Genes such as **CD3D** and **GNLY** are canonical cell type markers (for T cells and NK/CD8 T cells) that are virtually **unaffected by interferon stimulation** and **display similar gene expression patterns in the control and stimulated group**.*\n-   ***IFI6** and **ISG15**, on the other hand, are **core interferon response genes** and are **upregulated** accordingly **in all cell types**.*\n-   ***CD14** and **CXCL10** are genes that show a **cell type specific interferon response**.*\n    -   ***CD14** expression **decreases** after stimulation in **CD14 monocytes**, [which could lead to misclassification in a supervised analysis framework, underscoring the value of integrated analysis.]{.underline}**如果用于识别细胞类型的marker本身在不同的样本类型（处理 vs. 对照、恶性组织 vs. 正常组织）中存在表达量的差异，那么就会导致对细胞类型判断的错误。而本篇的数据整合则能够避免出现这种情况。***\n\n    -   ***CXCL10** shows a distinct **upregulation** in **monocytes** and **B cells** after interferon stimulation but not in other cell types.*\n:::\n\n------------------------------------------------------------------------\n\n# pseudobulking后的差异分析\n\n这一节为了演示pseudobulking，采用的仍然是“ifnb”数据集，仍然包括了“ctrl”和“stim”两个conditions，但是每个条件下都有多个重复，即多个来自不同患者的样本。同时，为了和[Seurat官方教程](https://satijalab.org/seurat/articles/de_vignette)一致，采用了`NormalizeData`对数据进行标准化。\n\n## 数据读取和预处理 {#数据读取和预处理}\n\nFor demonstration purposes, we will be using the interferon-beta stimulated human PBMCs dataset [@kang2017] that is available via the `SeuratData` package.\n\n::: {.callout-note collapse=\"true\" appearance=\"minimal\" icon=\"false\"}\n###### 在线读取（可能需要全局代理）\n\n\n::: {.cell hash='de_vignette_cache/html/unnamed-chunk-7_66a0b1ba8e02a41ebdb0569c90af29ba'}\n\n```{.r .cell-code}\nrm(list = ls())\nlibrary(Seurat)\nlibrary(SeuratData)\nInstallData(\"ifnb\")\nifnb <- LoadData(\"ifnb\")\n```\n:::\n\n:::\n\n从本地下载好的数据读取：\n\n\n::: {.cell hash='de_vignette_cache/html/unnamed-chunk-8_491c1e5faef6070ed0bedeb8c7bec07d'}\n\n```{.r .cell-code}\nrm(list = ls())\n\nlibrary(Seurat)\nifnb <- readRDS(\"data/seurat_official/pbmc_ifnb.rds\")\nifnb\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAn object of class Seurat \n14053 features across 13999 samples within 1 assay \nActive assay: RNA (14053 features, 0 variable features)\n 2 layers present: counts, data\n```\n:::\n\n```{.r .cell-code}\nhead(ifnb@meta.data, 5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                  orig.ident nCount_RNA nFeature_RNA stim seurat_annotations\nAAACATACATTTCC.1 IMMUNE_CTRL       3017          877 CTRL          CD14 Mono\nAAACATACCAGAAA.1 IMMUNE_CTRL       2481          713 CTRL          CD14 Mono\nAAACATACCTCGCT.1 IMMUNE_CTRL       3420          850 CTRL          CD14 Mono\nAAACATACCTGGTA.1 IMMUNE_CTRL       3156         1109 CTRL                pDC\nAAACATACGATGAA.1 IMMUNE_CTRL       1868          634 CTRL       CD4 Memory T\n```\n:::\n\n```{.r .cell-code}\nunique(ifnb$seurat_annotations) # 这里的数据已经提前注释好了细胞类型\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] CD14 Mono    pDC          CD4 Memory T T activated  CD4 Naive T \n [6] CD8 T        Mk           B Activated  B            DC          \n[11] CD16 Mono    NK           Eryth       \n13 Levels: CD14 Mono CD4 Naive T CD4 Memory T CD16 Mono B CD8 T ... Eryth\n```\n:::\n\n```{.r .cell-code}\n# 标准化\nifnb <- NormalizeData(ifnb)\n# 核对目前的默认assay，保证是RNA assay\nDefaultAssay(ifnb)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"RNA\"\n```\n:::\n:::\n\n\n## 直接通过`FindMarkers`寻找差异基因\n\n为了和pseudobulking后的差异分析结果进行比价，这里仍然先进行基于`FindMarkers`的简单差异表达分析，**寻找ctrl和stim之间在CD14单核细胞中的差异基因**。基本步骤和上面的[准备差异表达分析所需变量](#准备差异表达分析所需变量)一致。\n\n\n::: {.cell hash='de_vignette_cache/html/unnamed-chunk-9_0dae9d154a8e65848b360cbabfbd3b8a'}\n\n```{.r .cell-code}\nifnb$celltype.stim <- paste(ifnb$seurat_annotations, ifnb$stim, sep = \"_\")\nunique(ifnb$celltype.stim)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"CD14 Mono_CTRL\"    \"pDC_CTRL\"          \"CD4 Memory T_CTRL\"\n [4] \"T activated_CTRL\"  \"CD4 Naive T_CTRL\"  \"CD8 T_CTRL\"       \n [7] \"Mk_CTRL\"           \"B Activated_CTRL\"  \"B_CTRL\"           \n[10] \"DC_CTRL\"           \"CD16 Mono_CTRL\"    \"NK_CTRL\"          \n[13] \"Eryth_CTRL\"        \"CD8 T_STIM\"        \"pDC_STIM\"         \n[16] \"CD4 Naive T_STIM\"  \"B_STIM\"            \"CD14 Mono_STIM\"   \n[19] \"T activated_STIM\"  \"CD4 Memory T_STIM\" \"B Activated_STIM\" \n[22] \"NK_STIM\"           \"DC_STIM\"           \"CD16 Mono_STIM\"   \n[25] \"Mk_STIM\"           \"Eryth_STIM\"       \n```\n:::\n\n```{.r .cell-code}\nIdents(ifnb) <- \"celltype.stim\"\n\nmono.de <- FindMarkers(ifnb, \n                       ident.1 = \"CD14 Mono_STIM\", \n                       ident.2 = \"CD14 Mono_CTRL\", \n                       verbose = FALSE)\nnrow(mono.de)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 6956\n```\n:::\n\n```{.r .cell-code}\nhead(mono.de, n = 10)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        p_val avg_log2FC pct.1 pct.2 p_val_adj\nIFIT1       0   7.319139 0.985 0.033         0\nCXCL10      0   8.036564 0.984 0.035         0\nRSAD2       0   6.741673 0.988 0.045         0\nTNFSF10     0   6.991279 0.989 0.047         0\nIFIT3       0   6.883785 0.992 0.056         0\nIFIT2       0   7.179929 0.961 0.039         0\nCXCL11      0   8.624208 0.932 0.012         0\nCCL8        0   9.134191 0.918 0.017         0\nIDO1        0   5.455898 0.965 0.089         0\nMX1         0   5.059052 0.960 0.093         0\n```\n:::\n:::\n\n\n## 执行pseudobulking\n\nTo pseudobulk, we will use `AggregateExpression()` to sum together **gene counts of all the cells from the same sample** for each cell type. This results in **one gene expression profile per sample** **and cell type**. We can then perform DE analysis using [`DESeq2`](https://bioconductor.org/packages/release/bioc/html/DESeq2.html) **on the sample level**. This treats the samples, rather than the individual cells, as independent observations.\n\nFirst, we need to retrieve the sample information for each cell. This is not loaded in the metadata, so we will load it from the [Github repo](https://github.com/yelabucsf/demuxlet_paper_code/tree/master/) of the source data for the original paper.\n\n::: {.callout-tip collapse=\"true\"}\n###### Add sample information to the dataset\n\n\n::: {.cell hash='de_vignette_cache/html/unnamed-chunk-10_6343dd30ce5d258d67659d3f4389b20b'}\n\n````{.cell-code}\n```{{r}}\n#| eval: false\n\n# 从GitHub仓库读取（可能需要代理）\n# load the inferred sample IDs of each cell\nctrl <- read.table(url(\"https://raw.githubusercontent.com/yelabucsf/demuxlet_paper_code/master/fig3/ye1.ctrl.8.10.sm.best\"), head = T, stringsAsFactors = F)\nstim <- read.table(url(\"https://raw.githubusercontent.com/yelabucsf/demuxlet_paper_code/master/fig3/ye2.stim.8.10.sm.best\"), head = T, stringsAsFactors = F)\n```\n````\n:::\n\n::: {.cell hash='de_vignette_cache/html/unnamed-chunk-11_4a861bcbbbecfc6be34a4f9fd5db0b21'}\n\n```{.r .cell-code}\n# 这里提前下载好了两个样本信息文件，所以直接从本地读取\nctrl <- readRDS(\"data/seurat_official/inferred_sample_ids_ctrl.rds\")\nstim <- readRDS(\"data/seurat_official/inferred_sample_ids_stim.rds\")\ninfo <- rbind(ctrl, stim)\ninfo$BARCODE[1:5]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"AAACATACAATGCC-1\" \"AAACATACATTTCC-1\" \"AAACATACCAGAAA-1\" \"AAACATACCAGCTA-1\"\n[5] \"AAACATACCATGCA-1\"\n```\n:::\n\n```{.r .cell-code}\ncolnames(ifnb)[1:5]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"AAACATACATTTCC.1\" \"AAACATACCAGAAA.1\" \"AAACATACCTCGCT.1\" \"AAACATACCTGGTA.1\"\n[5] \"AAACATACGATGAA.1\"\n```\n:::\n\n```{.r .cell-code}\n# 可以看到两者的barcode形式不一致\n# rename the cell IDs by substituting the '-' into '.'\ninfo$BARCODE <- gsub(pattern = \"\\\\-\", replacement = \"\\\\.\", info$BARCODE)\ninfo$BARCODE[1:5]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"AAACATACAATGCC.1\" \"AAACATACATTTCC.1\" \"AAACATACCAGAAA.1\" \"AAACATACCAGCTA.1\"\n[5] \"AAACATACCATGCA.1\"\n```\n:::\n\n```{.r .cell-code}\n# only keep the cells with high-confidence sample ID\ninfo <- info[grep(pattern = \"SNG\", x = info$BEST), ]\n\n# remove cells with duplicated IDs in both ctrl and stim groups\ninfo <- info[!duplicated(info$BARCODE) & !duplicated(info$BARCODE, fromLast = T), ]\n\n# now add the sample IDs to ifnb \nrownames(info) <- info$BARCODE\ninfo <- info[, c(\"BEST\"), drop = F]\nnames(info) <- c(\"donor_id\")\nifnb <- AddMetaData(ifnb, metadata = info)\n\n# remove cells without donor IDs\nifnb$donor_id[is.na(ifnb$donor_id)] <- \"unknown\"\nifnb <- subset(ifnb, subset = donor_id != \"unknown\")\n```\n:::\n\n:::\n\n可以看到，现在的meta.dat中多了样本信息列（`donor_id`），记录了每个细胞来自哪个患者：\n\n\n::: {.cell hash='de_vignette_cache/html/unnamed-chunk-12_9e13394881322e58190999704484a382'}\n\n```{.r .cell-code}\nhead(ifnb@meta.data, 5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                  orig.ident nCount_RNA nFeature_RNA stim seurat_annotations\nAAACATACATTTCC.1 IMMUNE_CTRL       3017          877 CTRL          CD14 Mono\nAAACATACCAGAAA.1 IMMUNE_CTRL       2481          713 CTRL          CD14 Mono\nAAACATACCTCGCT.1 IMMUNE_CTRL       3420          850 CTRL          CD14 Mono\nAAACATACCTGGTA.1 IMMUNE_CTRL       3156         1109 CTRL                pDC\nAAACATACGATGAA.1 IMMUNE_CTRL       1868          634 CTRL       CD4 Memory T\n                     celltype.stim donor_id\nAAACATACATTTCC.1    CD14 Mono_CTRL SNG-1016\nAAACATACCAGAAA.1    CD14 Mono_CTRL SNG-1256\nAAACATACCTCGCT.1    CD14 Mono_CTRL SNG-1256\nAAACATACCTGGTA.1          pDC_CTRL SNG-1039\nAAACATACGATGAA.1 CD4 Memory T_CTRL SNG-1488\n```\n:::\n\n```{.r .cell-code}\ntable(ifnb$donor_id, ifnb$stim)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          \n           CTRL STIM\n  SNG-101   491  706\n  SNG-1015 1583 1533\n  SNG-1016  697  741\n  SNG-1039  270  393\n  SNG-107   331  321\n  SNG-1244 1023  975\n  SNG-1256 1160 1203\n  SNG-1488  865 1376\n```\n:::\n:::\n\n\n按照治疗分组（STIM vs. CTRL）、患者IDs、细胞类型（seurat_annotations）3个条件，执行pseudobulking (`AggregateExpression`)。通过`AggregateExpression`命令将同一类型的细胞按照不同的处理条件合并起来，形成一个假的组织水平的测序数据。本例中，有2个治疗分组、13种细胞类型和8个患者，总共被合并成206个类别，将每一个类别看作是一个样本，这样就形成了一个所谓的假的组织水平的测序数据。\n\n\n::: {.cell hash='de_vignette_cache/html/unnamed-chunk-13_7b6683a9ccbb770dcb76b8f8c0986f68'}\n\n```{.r .cell-code}\npseudo_ifnb <- AggregateExpression(ifnb, \n                                   assays = \"RNA\", \n                                   return.seurat = T, \n                                   group.by = c(\"stim\", \"donor_id\", \"seurat_annotations\"))\npseudo_ifnb\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAn object of class Seurat \n14053 features across 206 samples within 1 assay \nActive assay: RNA (14053 features, 0 variable features)\n 3 layers present: counts, data, scale.data\n```\n:::\n\n```{.r .cell-code}\nhead(pseudo_ifnb@meta.data) # 可以看到现在的表达矩阵的barcode变成了治疗分组+患者IDs+细胞类型\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                                         orig.ident stim donor_id\nCTRL_SNG-101_CD14 Mono       CTRL_SNG-101_CD14 Mono CTRL  SNG-101\nCTRL_SNG-101_CD4 Naive T   CTRL_SNG-101_CD4 Naive T CTRL  SNG-101\nCTRL_SNG-101_CD4 Memory T CTRL_SNG-101_CD4 Memory T CTRL  SNG-101\nCTRL_SNG-101_CD16 Mono       CTRL_SNG-101_CD16 Mono CTRL  SNG-101\nCTRL_SNG-101_B                       CTRL_SNG-101_B CTRL  SNG-101\nCTRL_SNG-101_CD8 T               CTRL_SNG-101_CD8 T CTRL  SNG-101\n                          seurat_annotations\nCTRL_SNG-101_CD14 Mono             CD14 Mono\nCTRL_SNG-101_CD4 Naive T         CD4 Naive T\nCTRL_SNG-101_CD4 Memory T       CD4 Memory T\nCTRL_SNG-101_CD16 Mono             CD16 Mono\nCTRL_SNG-101_B                             B\nCTRL_SNG-101_CD8 T                     CD8 T\n```\n:::\n:::\n\n\n然后和此前一样，我们在meta.data中增加一列，记录治疗分组（STIM vs. CTRL）+ 细胞类型，这是用于差异分析的分组依据。\n\n\n::: {.cell hash='de_vignette_cache/html/unnamed-chunk-14_f5d0687425b9c4579bdaf6ba6bab9a37'}\n\n```{.r .cell-code}\npseudo_ifnb$celltype.stim <- paste(pseudo_ifnb$seurat_annotations, \n                                   pseudo_ifnb$stim, \n                                   sep = \"_\")\nunique(pseudo_ifnb$celltype.stim)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"CD14 Mono_CTRL\"    \"CD4 Naive T_CTRL\"  \"CD4 Memory T_CTRL\"\n [4] \"CD16 Mono_CTRL\"    \"B_CTRL\"            \"CD8 T_CTRL\"       \n [7] \"T activated_CTRL\"  \"NK_CTRL\"           \"DC_CTRL\"          \n[10] \"B Activated_CTRL\"  \"Mk_CTRL\"           \"pDC_CTRL\"         \n[13] \"Eryth_CTRL\"        \"CD14 Mono_STIM\"    \"CD4 Naive T_STIM\" \n[16] \"CD4 Memory T_STIM\" \"CD16 Mono_STIM\"    \"B_STIM\"           \n[19] \"CD8 T_STIM\"        \"T activated_STIM\"  \"NK_STIM\"          \n[22] \"DC_STIM\"           \"B Activated_STIM\"  \"Mk_STIM\"          \n[25] \"pDC_STIM\"          \"Eryth_STIM\"       \n```\n:::\n:::\n\n\n## 执行差异分析 {#sec-perform_de_analysis}\n\nNext, we perform DE testing on the pseudobulk level for CD14 monocytes, and compare it against the previous single-cell-level DE results.\n\n::: callout-caution\n###### 安装`DESeq2`包\n\n由于pseudobulking后的`FindMarkers`差异分析需要采用`DESeq2`包提供的方法，所以需要提前安装`DESeq2`包：\n\n\n::: {.cell hash='de_vignette_cache/html/unnamed-chunk-15_b70143fb40aece01321904ad1c522dac'}\n\n````{.cell-code}\n```{{r}}\n#| eval: false\nBiocManager::install(\"DESeq2\")\n```\n````\n:::\n\n\n注意，如果是用`FindMarkers`来寻找细胞类型的marker基因，则一般采用默认的Wilcoxon Rank Sum Test方法，这时需要调用的是[`presto`](https://github.com/immunogenomics/presto) 包（见[FindMarkers-在特定cluster之间寻找marker基因](/single_cell/seurat/marker_gene_identification.qmd#sec-findmarkers_function)）。\n:::\n\n\n::: {.cell hash='de_vignette_cache/html/unnamed-chunk-16_c5b315f98fe2b63b6b3d1a6e9f3ef6cc'}\n\n```{.r .cell-code}\nIdents(pseudo_ifnb) <- \"celltype.stim\"\n\nbulk.mono.de <- FindMarkers(pseudo_ifnb, \n                            ident.1 = \"CD14 Mono_STIM\", \n                            ident.2 = \"CD14 Mono_CTRL\",\n                            test.use = \"DESeq2\") # 指定差异分析方法为\"DESeq2\"\nhead(bulk.mono.de, n = 15)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                 p_val avg_log2FC pct.1 pct.2     p_val_adj\nIL1RN    3.701542e-275   6.160156     1     1 5.201777e-271\nIFITM2   1.955626e-250   4.318976     1     1 2.748242e-246\nSSB      2.699554e-203   3.066647     1     1 3.793683e-199\nNT5C3A   2.239898e-198   5.412972     1     1 3.147729e-194\nRTCB     5.700554e-162   3.133362     1     1 8.010989e-158\nRABGAP1L 4.743010e-161   5.562364     1     1 6.665352e-157\nDYNLT1   9.735640e-159   2.402726     1     1 1.368150e-154\nPLSCR1   3.191691e-146   2.676047     1     1 4.485284e-142\nISG20    9.664488e-145   5.443114     1     1 1.358151e-140\nNAPA     2.858013e-144   1.977719     1     1 4.016365e-140\nDDX58    5.957026e-142   4.640111     1     1 8.371409e-138\nHERC5    6.333722e-133   5.266515     1     1 8.900780e-129\nOASL     3.892853e-130   3.946745     1     1 5.470627e-126\nEIF2AK2  6.636434e-128   3.940167     1     1 9.326180e-124\nTMEM50A  6.731955e-117   1.355947     1     1 9.460416e-113\n```\n:::\n:::\n\n\n::: {.callout-tip collapse=\"true\"}\n###### `FindMarkers`支持的差异分析方法\n\nWe also support many other DE tests using other methods. For completeness, the following tests are currently supported:\n\n-   \"wilcox\" : Wilcoxon rank sum test (default, using '[presto](https://github.com/immunogenomics/presto)' package)\n\n-   \"wilcox_limma\" : Wilcoxon rank sum test (using '[limma](https://bioconductor.org/packages/release/bioc/html/limma.html)' package)\n\n-   \"bimod\" : Likelihood-ratio test for single cell feature expression, (McDavid et al., Bioinformatics, 2013)\n\n-   \"roc\" : Standard AUC classifier\n\n-   \"t\" : Student's t-test\n\n-   \"poisson\" : Likelihood ratio test assuming an underlying negative binomial distribution. Use only for UMI-based datasets\n\n-   \"negbinom\" : Likelihood ratio test assuming an underlying negative binomial distribution. Use only for UMI-based datasets\n\n-   \"LR\" : Uses a logistic regression framework to determine differentially expressed genes. Constructs a logistic regression model predicting group membership based on each feature individually and compares this to a null model with a likelihood ratio test.\n\n-   \"MAST\" : GLM-framework that treates cellular detection rate as a covariate (Finak et al, Genome Biology, 2015) (Installation instructions)\n\n-   \"DESeq2\" : DE based on a model using the negative binomial distribution (Love et al, Genome Biology, 2014) (Installation instructions) For MAST and DESeq2, please ensure that these packages are installed separately in order to use them as part of Seurat. Once installed, use the test.use parameter can be used to specify which DE test to use.\n\n\n::: {.cell hash='de_vignette_cache/html/unnamed-chunk-17_d017d437674eece5b1b883e9bc19e29a'}\n\n```{.r .cell-code}\n# Test for DE features using the MAST package\n# BiocManager::install('limma')\nIdents(ifnb) <- \"seurat_annotations\"\nhead(FindMarkers(ifnb, \n                 ident.1 = \"CD14 Mono\", \n                 ident.2 = \"CD16 Mono\", \n                 test.use = \"wilcox_limma\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n               p_val avg_log2FC pct.1 pct.2     p_val_adj\nVMO1    0.000000e+00  -5.689802 0.084 0.777  0.000000e+00\nMS4A4A  0.000000e+00  -3.356037 0.141 0.747  0.000000e+00\nFCGR3A  0.000000e+00  -3.279465 0.418 0.982  0.000000e+00\nMS4A7   0.000000e+00  -2.390652 0.557 0.978  0.000000e+00\nRPS19   0.000000e+00  -1.321132 0.965 0.999  0.000000e+00\nFTL    1.636254e-307   1.318127 1.000 1.000 2.299427e-303\n```\n:::\n:::\n\n:::\n\n------------------------------------------------------------------------\n\n## 比较单细胞水平和pseudobulk水平的差异表达分析\n\n接下来，我们可以比较一下单细胞水平的差异表达分析的P值和pseudobulk水平的P值：\n\n\n::: {.cell hash='de_vignette_cache/html/unnamed-chunk-18_e490aa21a4d2d564902aa09b576033e7'}\n\n```{.r .cell-code}\nnames(bulk.mono.de) <- paste0(names(bulk.mono.de), \".bulk\") # 重命名列\nbulk.mono.de$gene <- rownames(bulk.mono.de)\n\nnames(mono.de) <- paste0(names(mono.de), \".sc\")\nmono.de$gene <- rownames(mono.de)\n\nmerge_dat <- merge(mono.de, bulk.mono.de, by = \"gene\")\nmerge_dat <- merge_dat[order(merge_dat$p_val.bulk), ]\n\n# 查看在两种差异分析方法中P值都有意义的基因名\ncommon <- merge_dat$gene[which(merge_dat$p_val.bulk < 0.05 & \n                                merge_dat$p_val.sc < 0.05)]\n# 查看在pseudobulk水平P>0.05但是在单细胞水平P<0.05的基因名：\nonly_sc <- merge_dat$gene[which(merge_dat$p_val.bulk > 0.05 & \n                                  merge_dat$p_val.sc < 0.05)]\n# 查看在pseudobulk水平P<0.05但是在单细胞水平P>0.05的基因名：\nonly_bulk <- merge_dat$gene[which(merge_dat$p_val.bulk < 0.05 & \n                                    merge_dat$p_val.sc > 0.05)]\nprint(paste0('# 在两种差异分析方法中P值都<0.05的基因有: ',length(common), \"个\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"# 在两种差异分析方法中P值都<0.05的基因有: 3519个\"\n```\n:::\n\n```{.r .cell-code}\nprint(paste0('# 仅在细胞水平差异分析中P值<0.05的基因有: ',length(only_sc), \"个\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"# 仅在细胞水平差异分析中P值<0.05的基因有: 1649个\"\n```\n:::\n\n```{.r .cell-code}\nprint(paste0('# 仅在pseudobulk差异分析中P值<0.05的基因有: ',length(only_bulk), \"个\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"# 仅在pseudobulk差异分析中P值<0.05的基因有: 204个\"\n```\n:::\n:::\n\n\n> We can see that while the p-values are correlated between the single-cell and pseudobulk data, the [**single-cell p-values are often smaller**]{.underline} and suggest higher levels of significance. In particular, there are 3,519 genes with evidence of differential expression (prior to multiple hypothesis testing) in both analyses, 1,649 genes that only appear to be differentially expressed in the single-cell analysis, and just 204 genes that only appear to be differentially expressed in the bulk analysis.\n\n接下来，我们通过小提琴图来检查两种方法中的Top共同差异基因在在刺激组和对照组的表达水平：\n\n\n::: {.cell hash='de_vignette_cache/html/unnamed-chunk-19_d3123610a5cb37f1463c4860281a9510'}\n\n```{.r .cell-code}\n# create a new column to annotate sample-condition-celltype in the single-cell dataset\nifnb$donor_id.stim <- paste0(ifnb$stim, \"-\", ifnb$donor_id)\nhead(ifnb@meta.data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                  orig.ident nCount_RNA nFeature_RNA stim seurat_annotations\nAAACATACATTTCC.1 IMMUNE_CTRL       3017          877 CTRL          CD14 Mono\nAAACATACCAGAAA.1 IMMUNE_CTRL       2481          713 CTRL          CD14 Mono\nAAACATACCTCGCT.1 IMMUNE_CTRL       3420          850 CTRL          CD14 Mono\nAAACATACCTGGTA.1 IMMUNE_CTRL       3156         1109 CTRL                pDC\nAAACATACGATGAA.1 IMMUNE_CTRL       1868          634 CTRL       CD4 Memory T\nAAACATACGGCATT.1 IMMUNE_CTRL       1581          557 CTRL          CD14 Mono\n                     celltype.stim donor_id donor_id.stim\nAAACATACATTTCC.1    CD14 Mono_CTRL SNG-1016 CTRL-SNG-1016\nAAACATACCAGAAA.1    CD14 Mono_CTRL SNG-1256 CTRL-SNG-1256\nAAACATACCTCGCT.1    CD14 Mono_CTRL SNG-1256 CTRL-SNG-1256\nAAACATACCTGGTA.1          pDC_CTRL SNG-1039 CTRL-SNG-1039\nAAACATACGATGAA.1 CD4 Memory T_CTRL SNG-1488 CTRL-SNG-1488\nAAACATACGGCATT.1    CD14 Mono_CTRL SNG-1015 CTRL-SNG-1015\n```\n:::\n\n```{.r .cell-code}\nunique(ifnb$celltype.stim)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"CD14 Mono_CTRL\"    \"pDC_CTRL\"          \"CD4 Memory T_CTRL\"\n [4] \"T activated_CTRL\"  \"CD4 Naive T_CTRL\"  \"CD8 T_CTRL\"       \n [7] \"Mk_CTRL\"           \"B Activated_CTRL\"  \"B_CTRL\"           \n[10] \"DC_CTRL\"           \"NK_CTRL\"           \"CD16 Mono_CTRL\"   \n[13] \"Eryth_CTRL\"        \"CD8 T_STIM\"        \"pDC_STIM\"         \n[16] \"CD4 Naive T_STIM\"  \"B_STIM\"            \"CD14 Mono_STIM\"   \n[19] \"T activated_STIM\"  \"CD4 Memory T_STIM\" \"B Activated_STIM\" \n[22] \"NK_STIM\"           \"DC_STIM\"           \"CD16 Mono_STIM\"   \n[25] \"Mk_STIM\"           \"Eryth_STIM\"       \n```\n:::\n\n```{.r .cell-code}\nIdents(ifnb) <- \"celltype.stim\"\n\n# 这里我们检查p_val.bulk最小的前两个Top差异基因\nprint(merge_dat[merge_dat$gene %in% common[1:2], c('gene','p_val.sc','p_val.bulk')])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       gene p_val.sc    p_val.bulk\n2785  IL1RN        0 3.701542e-275\n2739 IFITM2        0 1.955626e-250\n```\n:::\n\n```{.r .cell-code}\n# 在细胞类型水平（CD14 Mono）查看这两个Top差异基因在刺激组和对照组的表达水平\nVlnPlot(ifnb, \n        features = common[1:2], \n        idents = c(\"CD14 Mono_CTRL\", \"CD14 Mono_STIM\"), \n        group.by = \"stim\") \n```\n\n::: {.cell-output-display}\n![](de_vignette_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n::: {.cell hash='de_vignette_cache/html/unnamed-chunk-20_41b178afb3e45df769edd19c0fc25f7f'}\n\n```{.r .cell-code}\n# 在样本（患者）水平查看这两个Top差异基因在刺激组和对照组的表达水平\nVlnPlot(ifnb, \n        features = common[1:2], \n        idents = c(\"CD14 Mono_CTRL\", \"CD14 Mono_STIM\"), \n        group.by = \"donor_id.stim\", \n        ncol = 1) \n```\n\n::: {.cell-output-display}\n![](de_vignette_files/figure-html/unnamed-chunk-20-1.png){width=960}\n:::\n:::\n\n\n> In both the pseudobulk and single-cell analyses, the p-values for these two genes are astronomically small. For both of these genes, when just comparing all stimulated CD4 monocytes to all control CD4 monocytes across samples, we see much higher expression in the stimulated cells.\n>\n> When breaking down these cells by sample, we continue to see consistently higher expression levels in the stimulated samples compared to the control samples; in other words, this finding is not driven by just one or two samples. Because of this consistency, we find this signal in both analyses.\n\nBy contrast, we can examine examples of genes that are only DE under the single-cell analysis.\n\n\n::: {.cell hash='de_vignette_cache/html/unnamed-chunk-21_8a82874924ca26c3cc3aa0c03dd00f7b'}\n\n```{.r .cell-code}\nprint(merge_dat[merge_dat$gene %in% c('SRGN','HLA-DRA'), \n                c('gene','p_val.sc','p_val.bulk')])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        gene     p_val.sc p_val.bulk\n5710    SRGN 4.025076e-21  0.1823188\n2603 HLA-DRA 4.989863e-09  0.1851302\n```\n:::\n\n```{.r .cell-code}\nVlnPlot(ifnb, \n        features = c('SRGN','HLA-DRA'), \n        idents = c(\"CD14 Mono_CTRL\", \"CD14 Mono_STIM\"), \n        group.by = \"stim\") \n```\n\n::: {.cell-output-display}\n![](de_vignette_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n::: {.cell hash='de_vignette_cache/html/unnamed-chunk-22_a3c7c58a33f82f37fd434955217c922b'}\n\n```{.r .cell-code}\nVlnPlot(ifnb, \n        features = c('SRGN','HLA-DRA'), \n        idents = c(\"CD14 Mono_CTRL\", \"CD14 Mono_STIM\"), \n        group.by = \"donor_id.stim\", \n        ncol = 1) \n```\n\n::: {.cell-output-display}\n![](de_vignette_files/figure-html/unnamed-chunk-22-1.png){width=960}\n:::\n:::\n\n\n> Here, SRGN and HLA-DRA both have very small p-values in the single-cell analysis (on the orders of 10^−21^ and 10^−9^), but much larger p-values around 0.18 in the pseudobulk analysis. While there appears to be a difference between control and simulated cells when ignoring sample information, the signal is much weaker on the sample level, and we can see notable variability from sample to sample.\n\n所以，从这个例子中可以看出**pseudobulk后的差异分析的结果更加准确**。\n\n------------------------------------------------------------------------\n\n::: {.callout-note collapse=\"true\" icon=\"false\"}\n## Session Info\n\n\n::: {.cell hash='de_vignette_cache/html/unnamed-chunk-23_12f2732d743754939f626f64e265cfd7'}\n::: {.cell-output .cell-output-stdout}\n```\nR version 4.3.2 (2023-10-31)\nPlatform: aarch64-apple-darwin20 (64-bit)\nRunning under: macOS Sonoma 14.3\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib \nLAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\ntime zone: Asia/Shanghai\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] patchwork_1.2.0    Seurat_5.0.1       SeuratObject_5.0.1 sp_2.1-2          \n\nloaded via a namespace (and not attached):\n  [1] RColorBrewer_1.1-3          rstudioapi_0.15.0          \n  [3] jsonlite_1.8.8              magrittr_2.0.3             \n  [5] spatstat.utils_3.0-4        ggbeeswarm_0.7.2           \n  [7] farver_2.1.1                rmarkdown_2.25             \n  [9] zlibbioc_1.48.0             vctrs_0.6.5                \n [11] ROCR_1.0-11                 spatstat.explore_3.2-5     \n [13] RCurl_1.98-1.14             S4Arrays_1.2.0             \n [15] htmltools_0.5.7             SparseArray_1.2.3          \n [17] sctransform_0.4.1           parallelly_1.36.0          \n [19] KernSmooth_2.23-22          htmlwidgets_1.6.4          \n [21] ica_1.0-3                   plyr_1.8.9                 \n [23] plotly_4.10.4               zoo_1.8-12                 \n [25] igraph_1.6.0                mime_0.12                  \n [27] lifecycle_1.0.4             pkgconfig_2.0.3            \n [29] Matrix_1.6-5                R6_2.5.1                   \n [31] fastmap_1.1.1               MatrixGenerics_1.14.0      \n [33] GenomeInfoDbData_1.2.11     fitdistrplus_1.1-11        \n [35] future_1.33.1               shiny_1.8.0                \n [37] digest_0.6.34               colorspace_2.1-0           \n [39] S4Vectors_0.40.2            DESeq2_1.42.0              \n [41] tensor_1.5                  RSpectra_0.16-1            \n [43] irlba_2.3.5.1               GenomicRanges_1.54.1       \n [45] labeling_0.4.3              progressr_0.14.0           \n [47] fansi_1.0.6                 spatstat.sparse_3.0-3      \n [49] httr_1.4.7                  polyclip_1.10-6            \n [51] abind_1.4-5                 compiler_4.3.2             \n [53] withr_3.0.0                 BiocParallel_1.36.0        \n [55] fastDummies_1.7.3           MASS_7.3-60.0.1            \n [57] DelayedArray_0.28.0         tools_4.3.2                \n [59] vipor_0.4.7                 lmtest_0.9-40              \n [61] beeswarm_0.4.0              httpuv_1.6.13              \n [63] future.apply_1.11.1         goftest_1.2-3              \n [65] glue_1.7.0                  nlme_3.1-164               \n [67] promises_1.2.1              grid_4.3.2                 \n [69] Rtsne_0.17                  cluster_2.1.6              \n [71] reshape2_1.4.4              generics_0.1.3             \n [73] gtable_0.3.4                spatstat.data_3.0-4        \n [75] tidyr_1.3.0                 data.table_1.14.10         \n [77] XVector_0.42.0              utf8_1.2.4                 \n [79] BiocGenerics_0.48.1         spatstat.geom_3.2-7        \n [81] RcppAnnoy_0.0.21            ggrepel_0.9.5              \n [83] RANN_2.6.1                  pillar_1.9.0               \n [85] stringr_1.5.1               spam_2.10-0                \n [87] RcppHNSW_0.5.0              limma_3.58.1               \n [89] later_1.3.2                 splines_4.3.2              \n [91] dplyr_1.1.4                 lattice_0.22-5             \n [93] survival_3.5-7              deldir_2.0-2               \n [95] tidyselect_1.2.0            locfit_1.5-9.8             \n [97] miniUI_0.1.1.1              pbapply_1.7-2              \n [99] knitr_1.45                  gridExtra_2.3              \n[101] IRanges_2.36.0              SummarizedExperiment_1.32.0\n[103] scattermore_1.2             stats4_4.3.2               \n[105] xfun_0.41                   Biobase_2.62.0             \n[107] statmod_1.5.0               matrixStats_1.2.0          \n[109] stringi_1.8.3               lazyeval_0.2.2             \n[111] yaml_2.3.8                  evaluate_0.23              \n[113] codetools_0.2-19            tibble_3.2.1               \n[115] cli_3.6.2                   uwot_0.1.16                \n[117] xtable_1.8-4                reticulate_1.34.0          \n[119] munsell_0.5.0               GenomeInfoDb_1.38.5        \n[121] Rcpp_1.0.12                 globals_0.16.2             \n[123] spatstat.random_3.2-2       png_0.1-8                  \n[125] ggrastr_1.0.2               parallel_4.3.2             \n[127] ellipsis_0.3.2              ggplot2_3.4.4              \n[129] presto_1.0.0                dotCall64_1.1-1            \n[131] bitops_1.0-7                listenv_0.9.0              \n[133] viridisLite_0.4.2           scales_1.3.0               \n[135] ggridges_0.5.5              crayon_1.5.2               \n[137] leiden_0.4.3.1              purrr_1.0.2                \n[139] rlang_1.1.3                 cowplot_1.1.2              \n```\n:::\n:::\n\n:::\n\n# References {.unnumbered}\n\n::: {#refs}\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}